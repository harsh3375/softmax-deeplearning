def stable_softmax(X):
    exps = np.exp(X - np.max(X))
    return exps / np.sum(exps)
